@model FamilyBudget.Models.View.Edit.HomeProjectEditModel

@{
    ViewData["Title"] = "Edit";
}

<h1>Edit</h1>

<div id="projectDetailsModal" class="modal fade">
    <div id="projectDetailsDialogContent" class="modal-dialog modal-dialog-centered modal-lg"></div>
</div>


<div class="row">
    <div class="container-fluid">
        <form asp-controller="Projects" asp-action="Edit" asp-route-id="@Model.projectId">
            <div class="form-group">
                <label asp-for="@Model.project.Name" class="control-label"></label>
                <input asp-for="@Model.project.Name" class="form-control" placeholder="Project name" />
                <input type="hidden" asp-for="@Model.project.Id" />
                <input type="hidden" asp-for="@Model.project.OwnerId" />
                <span asp-validation-for="@Model.project.Name" class="text-danger"></span>
            </div>

            <div class="row">
                <div class="col-4">
                    <h4 class="text-center">Categories</h4>
                    <a class="addCategory pull-right bi bi-plus-circle" style="cursor: pointer"></a>

                    <div id="categoryList" class="list-group">
                        @foreach (var item in @Model.categories)
                        {
                            <a class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">
                                <span class="p-2 projectListItem list-group-item-action flex-grow-1">
                                    @Html.DisplayFor(modelItem => item.Name)
                                </span>

                                <i id="@item.Id" class="bi bi-pencil projectEdit mr-2"></i>
                                <i id="@item.Id" class="bi bi-x-lg projectDelete"></i>
                            </a>
                        }
                    </div>
                </div>
                <div class="col-8">
                    <h4 class="text-center">ProjectMembers</h4>
                    <a class="addProjectMember pull-right bi bi-plus-circle" style="cursor: pointer"></a>

                    <div id="projectMemberList" class="list-group" count="@Model.projectMembers.Count">

                        @foreach (var item in @Model.projectMembers)
                        {
                            <a class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">
                                <span class="p-2 projectListItem list-group-item-action flex-grow-1">
                                    @Html.DisplayFor(modelItem => item.NameInProject)
                                </span>

                                <i id="@item.Id" class="bi bi-pencil projectEdit mr-2"></i>
                                <i id="@item.Id" class="bi bi-x-lg projectDelete"></i>
                            </a>
                        }
                    </div>
                </div>
            </div>
            <div class="pull-right">
                <input class="btn btn-primary mr-2" type="submit" value="Save" />
                <a class="btn btn-secondary" asp-action="Index">Back</a>
            </div>
        </form>
    </div>
</div>

@section scripts
{
    <script type="text/javascript">
        
        $(".projectEdit").click(function (e) {
                e.preventDefault();
                document.location.href = "Home/Edit/" + this.id;               
            });
       
        $.ajaxSetup({ cache: false });

        // ProjectMember

        $(".projectMemberCreate").click(function (e) {
            e.preventDefault();
            $.get("Modal/ProjectMemberCreate/" + this.id, function (data) {
                $('#projectDetailsDialogContent').html(data);
                $('#projectDetailsModal').modal('show');
            });
        });

        $(".projectMemberEdit").click(function (e) {
            e.preventDefault();
            $.get("Modal/ProjectMemberCreate/" + this.id, function (data) {
                $('#projectDetailsDialogContent').html(data);
                $('#projectDetailsModal').modal('show');
            });
        });

        $(".projectMemberDelete").click(function (e) {
            e.preventDefault();
            $.get("Modal/ProjectMemberDelete/" + this.id, function (data) {
                $('#projectDetailsDialogContent').html(data);
                $('#projectDetailsModal').modal('show');
            });
        });

        // Category

        $(".categoryCreate").click(function (e) {
            e.preventDefault();
            $.get("Modal/categoryCreate/" + this.id, function (data) {
                $('#projectDetailsDialogContent').html(data);
                $('#projectDetailsModal').modal('show');
            });
        });

        $(".projectMemberCreate").click(function (e) {
            e.preventDefault();
            $.get("Modal/ProjectMemberCreate/" + this.id, function (data) {
                $('#projectDetailsDialogContent').html(data);
                $('#projectDetailsModal').modal('show');
            });
        });

        $(".categoryDelete").click(function (e) {
            e.preventDefault();
            $.get("Modal/categoryDelete/" + this.id, function (data) {
                $('#projectDetailsDialogContent').html(data);
                $('#projectDetailsModal').modal('show');
            });
        });
        
    </script>
}